#!/bin/sh
echo "Pre-commit hook triggered at $(date)" >> /tmp/precommit.log

# Log current PATH
echo "PATH: $PATH" >> /tmp/precommit.log

# Check if dotnet is available
if ! command -v dotnet >/dev/null 2>&1; then
  echo "dotnet is not found in PATH" >> /tmp/precommit.log
  exit 1
fi

# Run dotnet format
dotnet format >> /tmp/precommit.log 2>&1
if [ $? -eq 0 ]; then
  git add .
  echo "dotnet format succeeded, changes staged" >> /tmp/precommit.log
else
  echo "dotnet format failed" >> /tmp/precommit.log
  exit 1
fi
